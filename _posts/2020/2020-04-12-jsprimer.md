---
title: "JavaScript Primer発売開始！/JavaScript Primerはなぜ書かれたのか？"
author: azu
layout: post
date : 2020-04-12T17:41
category: JavaScript
tags:
    - JavaScript
    - book

---

# この書籍はなぜ書かれたのか？ {#afterword}

この付録では、[JavaScript Primer][]がなぜ作られたのかについて見ていきます。

「[はじめに][]」では、この書籍の目的を紹介しましたが、なぜその目的に対してこの書籍が書かれたのかを見ていきます。

## この書籍の目的 {#do}

この書籍の目的は、JavaScriptというプログラミング言語を学ぶ必要が出てきた人が、一からJavaScriptを学べるようにすることです。
この「JavaScriptを学ぶ」には基本的な書き方を知るという意味もありますが、設計を考えてJavaScriptアプリケーションを作れるようになることも目的に含まれています。

また、JavaScriptはECMAScriptという仕様が毎年更新されているように、常に変化している言語です。そのため、JavaScriptの変化に対して対応できるように学び方を学べる必要もありました。

最終的にこの書籍の目的は大きく分けて次の3つとなりました。

- 書き方: 基本文法などのJavaScriptの書き方
- 作り方: JavaScriptを使ったアプリケーションの作り方
- 学び方: JavaScriptの進化を自分で知る学び方

これら3つを一冊の書籍で扱うため、基本を学びつつそれでいて現実のユースケースからは離れすぎないというバランスを一緒に扱うことを決めました。

## なぜ「書き方」「作り方」「学び方」なのか？ {#three-principle}

JavaScript Primerは[2015-12-17](https://github.com/asciidwango/js-primer/tree/master/meetings/2015-12-17)から始まったプロジェクトです。
最初からOSSとして書籍を書くという目的だったので、すべてのミーティングログが公開されています。

- https://github.com/asciidwango/js-primer/tree/master/meetings

最初期の[2016-01-29のミーティング](https://github.com/asciidwango/js-primer/tree/master/meetings/2016-01-29)で書籍の内容をどうするべきかというミーティングで次のようなスライドを発表しています。

- スライド: [ES6本](https://github.com/asciidwango/js-primer/blob/master/meetings/2016-01-29/azu/startup-book.pdf)

このスライドでは、この書籍がどのような目標で書かれるべきかを話しています。

事前に[JavaScriptのレベル別書籍のまとめ](https://gist.github.com/azu/027859e08e284cb8dfe7)を調べた所、この時点ではES2015をベースにしたJavaScript初心者向けの書籍がありませんでした。

![ES6をベースとした書籍がない](https://efcl.info/wp-content/uploads/2020/04/12-1586680929.png)

そこで新しいJavaScriptの書籍を作ろうという話が始まり、jsprimerは次のような目的で始まっています。

```
目的
• 現代的なJavaScriptについて理解できるようにする
• 「!これ読んでおいて」と渡せる書籍
• ES2015/ES2016...と言うような新しいものが出てきたら時に 取り組める素養を付く
```

その中で、どんな書籍も最終的に学ぶJavaScriptという言語なのでそこは大きく変わらないはずです。そのため、書籍として学ぶ際のどのようにつまづきどころを減らすことに焦点をおいていました。

学ぶ際のフィードバックループとして、[作りながら学ぶRuby入門](http://rubybook.vacco.net/)では、学んだ文法でプログラムを作り改良点を検討するという話が書かれています。

![作りながら学ぶRuby入門](https://efcl.info/wp-content/uploads/2020/04/12-1586681905.png)

jsprimerでも同じように、基本文法で学んだ知識をユースケースのアプリとして実装するという流れにするのがハマりどころを減らすことができると考えました。

一方でJavaScriptには膨大な機能なので最初にやらないことを決めておかないと収拾がつかないので、この時点ですべての機能を網羅することは目的外としました。

そのため、まず現実でのユースケースを考えて、そのユースケースを理解するために必要な文法を探すという逆説的な形で内容を決めていきました。

![どのように書くか](https://efcl.info/wp-content/uploads/2020/04/12-1586682965.png)

そして、最初の目的を満たすために、「書き方」「使い方」「学び方」を学べることが必要だろうという結論になりました。

```
Re:目的
• JavaScriptについて理解できるようにする
 • →書き方(文法)を学ぶ
• JavaScriptで書かれたものを理解できるようにする
 • →使い方(ユースケース)を学ぶ
• 新しいものが出てきたら時に取り組める素養を付ける
 • →学び方を学ぶ
```

この3つの原則は書籍の構成にも現れています。
第一部の基本文法で「書き方」を学び、第二部のユースケースで「作り方」を学べるようになっています。

「学び方」は、章としてではなく全体的な流れとして取り入れることにしました。
なぜなら、「学び方」自体は学びたいことによっても異なる方法を取る場合があります。
そのため、「学び方」で個別の章とするよりは、他の章で「書き方」や「作り方」と一緒に見たほうがよいと考えたためです。

たとえば、基本文法などの学び方にはMDNのようなリファレンスサイトを見たほうがいいし、
アプリケーションの作り方は実際のサイトなどを参考にしたほうがよいためです。

第一部と第二部がどのように書かれたのかをざっくりと振りかえってみます。

## [第一部: 基本文法](https://jsprimer.net/basic/) {#basic}

[第一部: 基本文法](https://jsprimer.net/basic/)はJavaScriptの基本的な文法について扱っています。

プログラミングの入門書で文法については避けることはできませんが、この書籍も同様です。

しかしECMAScriptの仕様がどんどん巨大化しているため、すべての文法を紹介するのは無理があります。使わない機能も紹介していくと、無駄なはまりどころを増やしてしまうというのが見えていました。

そのため、この書籍の基本文法は引き算の考え方で書かれていて、入門として必要ないと判断したものはどんどん落としていっています。
また、最初の目的でも話したように、ユースケースがある基本文法を扱っているため、ユースケースがはっきりしてないものは省略しています。

省略した機能があることについては、第一部の終わりの章でも触れています。

- [第一部: おわりに · JavaScript Primer #jsprimer](https://jsprimer.net/basic/other-parts/)

基本文法で扱う機能（章）を決めたあとも章ごとのバランスを何度も調整しています。
特定の章に文量が偏ったり、特定の章に話が集中してしまうと読者がつまづくしまうポイントとなります。（たとえば、突然難しい章がでてくるとそこで読むのを諦めてしまうなど）

そのため、どうやったらなめらかに読めるかをベースに章の配分や順番は何度も調整しています。

たとえば、[textstat](https://github.com/textlint/textstat)という自作のツールを使って章ごとの分量を可視化して調整したり、章の依存関係（リンク）を調べて並び替えとかを行っています。

| 章ごとのファイルサイズ             |  章の依存関係 |
:-------------------------:|:-------------------------:
| ![章ごとのファイルサイズ](https://efcl.info/wp-content/uploads/2020/04/12-1586698537.png) | ![章の依存関係](https://efcl.info/wp-content/uploads/2020/04/12-1586698576.png) | 


- [章ごとのページ量を可視化する · Issue #554 · asciidwango/js-primer](https://github.com/asciidwango/js-primer/issues/554)

<!-- textlint-disable -->

パフォーマンスチューニングも同じですが、山（章の文量）が急に上がると体感が悪くなる（FPSが下がって画面がガクつくなど）ので、この山をなめらかにするイメージで調整していました。

<!-- textlint-enable -->

文量は調整していますが、[関数とthis](https://jsprimer.net/basic/function-this/)や[非同期処理:コールバック/Promise/Async Function ](https://jsprimer.net/basic/async/)のように長い章もあります。
これらの章は、`this`や`Promise`などの概念そのものが複雑なので、できるだけ丁寧に説明するために文量が増えてしまっています。

第一部全体で気をつけている部分として、基本文法であっても実際のユースケースから離れすぎないことです。
この書籍は文法を紹介するリファレンス本になるのが目的ではありません。（詳しくは「[本書の目的ではないこと](https://jsprimer.net/intro/#do-not)」を参照）
そのため。必要な文法は紹介しつつ、実際の使われ方も合わせて紹介しています。

たとえば、「[ループと反復処理](https://jsprimer.net/basic/loop/)」の章は、`for`文などの反復処理について紹介しています。しかし反復処理において`for`文や`while`文についてだけを学ぶのは、文法的なグルーピングとしては正しいですが、現実とは少し離れています。

なぜなら現実では`Array#map`などのメソッドが使われることも多いからです。
そのため、この章では`for`文などと対応する配列のメソッドでの書き方についても一緒に扱っています。また、現実のコードではどちらも使う機会があるので、[どちらか一方が正しいわけではない](https://jsprimer.net/basic/loop/#conclusion)という話もしています。

[第一部: 基本文法](https://jsprimer.net/basic/)は基本的には「書き方」を学べるように書いていますが、「学び方」については色々な章でちりばめて書いています。

たとえば、「[文字列とUnicode](https://jsprimer.net/basic/string-unicode/)」の章では、Unicodeの問題はJavaScriptに限定された問題ではないため、他の言語も参考できるという話をしています。
また、「[ECMAScript](https://jsprimer.net/basic/ecmascript/)」の章では、JavaScriptの仕様であるECMAScriptがどのように更新されているかやそのプロセスを解説しています。新しい機能を学ぶだけでなく、なぜその機能が追加されるのかについて考えてみようという話もしています。

あとは、[エラーの読み方や調べ方](https://jsprimer.net/basic/read-eval-print/#eval-code-and-error)、リファレンスとして[MDN][]も併用しましょうという話もしています。

この辺は実際にコードを書いていて問題が起きたときにどう直し方を見つけるかという部分を反映しています。

## [第二部: ユースケース](https://jsprimer.net/use-case/) {#usecase}

[第二部: ユースケース](https://jsprimer.net/use-case/)では、[第一部: 基本文法](https://jsprimer.net/basic/)で学んだことを生かして小さなアプリケーションを作りながら学べます。

第二部での一番の迷いどころは、現実のアプリケーションコードの97%はnpmからきたライブラリであるという話がある程度には、ライブラリの占める割合が大きいという話です。

> In fact, 97% of the code in a modern web application comes from npm.
> 
> -- https://medium.com/npm-inc/this-year-in-javascript-2018-in-review-and-npms-predictions-for-2019-3a3d7e5298ef#49d6

そのため、JavaScriptを使ったアプリケーションの「作り方」を学ぶ上では、ライブラリを使うことは避けられません。

一方で、ライブラリがメジャーアップデートされるとコードの互換性がないことも多いため、書籍でライブラリを扱うのは難しいという問題があります。

この書籍は[ライブラリの使い方を学ぶのは目的ではありません](https://jsprimer.net/intro/#do-not)。あくまで学びたいのはライブラリの扱い方であって、別のライブラリであっても同じように扱えるようにすることが目的です。そのため、ライブラリへの依存を最小限にしつつ、実際にライブラリをどう扱うかの工夫が必要でした。

[ユースケース: Node.jsでCLIアプリケーション](https://jsprimer.net/use-case/nodecli/)では実際に著名な`commander`や`mocha`などのライブラリを使ってCLIアプリを作成しています。それ以外のユースケースで使うローカルサーバーなどは[書籍専用のものを作成](https://github.com/js-primer/local-server)してコントロールできるようにしています。

この書籍の最後の章は[ユースケース: Todoアプリ](https://jsprimer.net/use-case/todoapp/)です。
この書籍の目的は読み終わった時にちゃんとJavaScriptの設計ができることを目的としていました。

現実の設計にはモジュール化の概念は切り離すことができません。一方でモジュール化は書籍のような決まった枠がある2次元的なものだと見通しが悪くなりやすいので扱いにくい話題です。

そのため、できるだけ自然な流れでモジュールを取り入れたアプリケーション開発をしていく必要があり、設計をするにはリファクタリングも内容として含めたものを目指していました。
一方で、JavaScriptには統一的なUIフレームワークやコーディングスタイルなどは存在しません。しかし、これもJavaScriptらしさではあります。

> JavaScriptは、癖を許さないとか制限がきついなどとは、まるで反対の立場だ。だから、効果的なプログラムを目指すJavaScript開発者は、ほかの大部分のプログラミング言語よりずっと、より良いスタイル、適切な使い方、ベストプラクティスを学び、追求する必要がある。
> 
> -- Brendan Eich -- [Effective JavaScript](https://www.amazon.co.jp/dp/B00EESW7JQ/)

その中で、設計のプロトタイプとして使い古されているものとして[TodoMVC](http://todomvc.com/)があります。

このTodoアプリはさまざまなライブラリを使った実装が存在し、そのひとつの実装をこの書籍で書いてみるというのがゴールにマッチしていそうなのでこの題材にしました。
TodoMVC自体は、使い古されたものでありやや古い感じはありますが、ネットワークなど不必要で依存もなく紙面で扱いやすいのも理由のひとつです。

もっと同じようなひとつのテーマをもとにした複数の実装を見たい方は[RealWorld](https://github.com/gothinkster/realworld)やHackerNews クローンなどがあります。そこまでたどり着いているなら、この書籍のゴールである「設計について考える」ことができているはずです。

## この本によって何が学べないのか？ {#not-learn}

最後にこの書籍では何を学べないかについてです。

JavaScriptの変化に対応できる基礎を学ぶことを目的としています。
一方で、この書籍ではできるだけ変化しやすいものは排除するような構成にしています。

たとえばjQueryやReact、Angularなどのライブラリやフレームワーク、Babel、[webpack][]などのツールなどが本書ではほとんど出てこないのはこの変化を減らすためです。
別のツールが登場することによる移り変わりも存在しますが、同じツール自体がでも世の中の変化に応じて役割が変わるものもあります。

たとえば、[webpack][]や[browserify][]といったbundlerと呼ばれるツールの初期の目的は、Node.js向けに書かれたnpmパッケージをブラウザで動かすことでした。
しかし、現在では最初からブラウザ向けのライブラリがnpmで公開されており、Node.js向けに書かれたものをブラウザで動かす（polyfill）するのが主目的ではなくなりました。
そのため、現在のBundlerはNode.jsモジュールをブラウザ向けにpack（polyfill）する役割から、モジュールを最適化してビルド（bundle）する役割へ変わってきています。

- [JSerレポート #2: Node.jsコアモジュールとBundler(webpackなど)によるpolyfillのギャップ - JSer.info](https://jser.info/2018/12/25/node-browser-libs-gap/)

このようにツールの役割が変化することもあります。
これはエコシステムの変化です。

ウェブブラウザやECMAScriptは後方互換性を維持しつつ、新しい機能を含んだアップデートを続けるという一見矛盾したものを両立することを選択しています。エコシステムはこの変化の中間にあるため、必然的に激しい変化が必要になります。

JavaScriptが複雑さは「変化をしつづけること」と「後方互換性を守る」の両方やろうとしていることからきているケースは多いです。
この変化を支えるのはライブラリやツールといったエコシステムであるため、よく見る「JavaScriptの複雑だ」という意見はエコシステムを見ている可能性があります。

この書籍は、JavaScriptの変化に対応できる基礎を学ぶのが目的であるため、複雑さはできるだけ排除しています。そのため、この書籍では新しいツールの使い方、ライブラリの使い方、ライブラリのアップデート方法といったエコシステムの変化は学ぶことができません。

---

これはエコシステムの変化
- JavaScriptのツールなどのエコシステムがなぜ変化し続けるのかについては、世界の法則を探すようなもので明確な理由はありませんが、そのポイントは存在します
- そこに至るには長い歴史があります
- また、ECMAScriptの章で紹介したようにJavaScriptは常に仕様が更新されています
- この書籍が発行された後も必然的に、新しい構文が追加されたりします
- この構文はProposalという形で提案され仕様に入るというステップを紹介していました
- このステップがあるため、実は仕様に入る前に9割ぐらいの可能性で入るかどうかはわかりますが、その未来の仕様については意図的に含めていません
- その未来については各自で学べる、つまりつけるようにするというもが目的である「学び方を学ぶ」という話となります。本書を読めばどこを探せばその未来についての議論がされているかは検索できるようになっているはずだからです

---

そのため、この書籍では未来のことは学べません。未来については自分で考えてみてください。

[はじめに]: ../../intro/README.md
[JavaScript Primer]: https://jsprimer.net
[MDN]: https://developer.mozilla.org/j
[webpack]: https://webpack.js.org/
[browserify]: https://github.com/browserify/browserify